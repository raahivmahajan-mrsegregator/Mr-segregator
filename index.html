<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Smart Bin Sorter ‚Äì Playable Game</title>
<style>
  body{
    margin:0;
    font-family:'Segoe UI',Arial,sans-serif;
    background:radial-gradient(circle at top,#e8f5e9,#a5d6a7);
    display:flex;
    flex-direction:column;
    align-items:center;
  }
  canvas{
    display:block;
    margin:20px auto;
    background:linear-gradient(180deg,#f7fcff,#eef7ef);
    border-radius:26px;
    box-shadow:0 18px 45px rgba(0,0,0,.35), inset 0 3px 8px rgba(255,255,255,.6);
  }
  .overlay{
    position:fixed;inset:0;
    background:rgba(0,0,0,.75);
    color:#fff;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    text-align:center;
  }
  button{
    padding:14px 26px;
    margin:10px;
    font-size:17px;
    border-radius:12px;
    border:none;
    cursor:pointer;
    background:#4caf50;
    color:white;
  }
  button:hover{opacity:.9}
</style>
</head>
<body>

<canvas id="game" width="360" height="600"></canvas>

<div style="text-align:center">
  <button id="langEn">English</button>
  <button id="langHi">‡§π‡§ø‡§Ç‡§¶‡•Ä</button>
</div>

<div id="intro" class="overlay">
  <h1>‚ôªÔ∏è Smart Bin Sorter</h1>
  <p>Catch falling waste ‚Ä¢ Choose the right bin</p>
  <button id="easyBtn">‚ñ∂ Easy</button>
  <button id="hardBtn">üî• Hard</button>
</div>

<div id="gameover" class="overlay" style="display:none">
  <h2>Game Over</h2>
  <p id="final"></p>
  <button id="restartBtn">üîÅ Play Again</button>
</div>

<script>
// ===== AUDIO =====
let audioUnlocked = false;
const dingSound = new Audio('https://actions.google.com/sounds/v1/cartoon/coin_collect.ogg');
const noSound  = new Audio('https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg');
document.addEventListener('pointerdown',()=>{audioUnlocked=true;},{once:true});

const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

let score = 0;
let speed = 2.2;
let running = false;
let lang = 'en';

let trashHeight = 0;
const trashLimit = 140;
let showDing = 0;

const bins = [
  { n: 'Wet', e: 'üóëÔ∏è', c:'#4caf50' },
  { n: 'Dry', e: 'üóëÔ∏è', c:'#2196f3' },
  { n: 'Hazard', e: '‚ò£Ô∏è', c:'#f44336' },
  { n: 'Medical', e: 'üè•', c:'#ff9800' }
];

let selectedBin = 1;
let binX = 120;

const wastes = [
  { t: 'Wet', e: 'üçå', en: 'Banana Peel', hi: '‡§ï‡•á‡§≤‡•á ‡§ï‡§æ ‡§õ‡§ø‡§≤‡§ï‡§æ' },
  { t: 'Wet', e: 'üçé', en: 'Apple Core', hi: '‡§∏‡•á‡§¨ ‡§ï‡§æ ‡§¨‡•Ä‡§ú' },
  { t: 'Wet', e: 'ü•¨', en: 'Vegetable Waste', hi: '‡§∏‡§¨‡•ç‡§ú‡§º‡•Ä ‡§ï‡§ö‡§∞‡§æ' },

  { t: 'Dry', e: 'üß¥', en: 'Plastic Bottle', hi: '‡§™‡•ç‡§≤‡§æ‡§∏‡•ç‡§ü‡§ø‡§ï ‡§¨‡•ã‡§§‡§≤' },
  { t: 'Dry', e: 'üì¶', en: 'Cardboard Box', hi: '‡§ï‡§æ‡§∞‡•ç‡§°‡§¨‡•ã‡§∞‡•ç‡§° ‡§°‡§ø‡§¨‡•ç‡§¨‡§æ' },
  { t: 'Dry', e: 'ü•´', en: 'Metal Can', hi: '‡§ß‡§æ‡§§‡•Å ‡§ï‡§æ ‡§°‡§ø‡§¨‡•ç‡§¨‡§æ' },

  { t: 'Hazard', e: 'üîã', en: 'Used Battery', hi: '‡§ñ‡§∞‡§æ‡§¨ ‡§¨‡•à‡§ü‡§∞‡•Ä' },
  { t: 'Hazard', e: 'üí°', en: 'Broken Bulb', hi: '‡§ü‡•Ç‡§ü‡§æ ‡§¨‡§≤‡•ç‡§¨' },

  { t: 'Medical', e: 'üíâ', en: 'Syringe', hi: '‡§∏‡§ø‡§∞‡§ø‡§Ç‡§ú' },
  { t: 'Medical', e: 'ü©π', en: 'Bandage', hi: '‡§™‡§ü‡•ç‡§ü‡•Ä' }
];

let waste = null;

function spawnWaste(){
  const r = wastes[Math.floor(Math.random()*wastes.length)];
  waste = {...r, x: Math.random()*280 + 40, y: -40};
}

function startGame(mode){
  speed = mode==='hard'?3.5:2.2;
  score = 0;
  trashHeight = 0;
  selectedBin = 1;
  binX = 120;
  spawnWaste();
  running = true;
  document.getElementById('intro').style.display='none';
}

function endGame(){
  running = false;
  document.getElementById('final').innerText = `Score: ${score}\nTrash Overflowed!`;
  document.getElementById('gameover').style.display='flex';
}

restartBtn.onclick = ()=>{
  document.getElementById('gameover').style.display='none';
  document.getElementById('intro').style.display='flex';
};

easyBtn.onclick = ()=>startGame('easy');
hardBtn.onclick = ()=>startGame('hard');
langEn.onclick = ()=>lang='en';
langHi.onclick = ()=>lang='hi';

addEventListener('keydown',e=>{
  if(!running||!waste) return;
  if(e.key>='1'&&e.key<='4') selectedBin=parseInt(e.key)-1;
  if(e.key==='ArrowLeft') binX=Math.max(0,binX-25);
  if(e.key==='ArrowRight') binX=Math.min(240,binX+25);
});

function drawTrashMountain(){
  if(trashHeight<=0) return;
  ctx.fillStyle='#8d6e63';
  ctx.beginPath();
  ctx.moveTo(0,600);
  ctx.quadraticCurveTo(180,600-trashHeight-40,360,600);
  ctx.fill();
}

function drawBin(){
  ctx.fillStyle=bins[selectedBin].c;
  ctx.beginPath();
  ctx.roundRect(binX,470,120,90,18);
  ctx.fill();

  ctx.font='32px Apple Color Emoji, Segoe UI Emoji';
  ctx.textAlign='center';
  ctx.fillStyle='#fff';
  ctx.fillText(bins[selectedBin].e,binX+60,505);

  ctx.font='14px Arial';
  ctx.fillText(bins[selectedBin].n+' Bin',binX+60,575);
}

function drawUI(){
  ctx.fillStyle='#2e7d32';
  ctx.font='18px Arial';
  ctx.textAlign='left';
  ctx.fillText('Smart Bin Sorter',20,30);
  ctx.font='14px Arial';
  ctx.fillText('Score: '+score,260,30);

  if(showDing>0){
    ctx.font='18px Arial';
    ctx.fillStyle='#ffeb3b';
    ctx.textAlign='center';
    ctx.fillText('ding, ding, ding, ding',180,70);
    showDing--;
  }
}

function loop(){
  ctx.clearRect(0,0,360,600);
  if(!running){ requestAnimationFrame(loop); return; }

  drawTrashMountain();
  drawUI();

  waste.y += speed;
  ctx.font='40px Apple Color Emoji, Segoe UI Emoji';
  ctx.textAlign='center';
  ctx.fillStyle='#000';
  ctx.fillText(waste.e,waste.x,waste.y);

  ctx.font='14px Arial';
  ctx.fillStyle='#333';
  ctx.fillText(lang==='en'?waste.en:waste.hi,waste.x,waste.y+22);

  if(waste.y>500){
    if(bins[selectedBin].n===waste.t){
      score += 10;
      showDing = 40;
      if(audioUnlocked){ dingSound.currentTime=0; dingSound.play(); }
    } else {
      trashHeight += 30;
      if(audioUnlocked){ noSound.currentTime=0; noSound.play(); }
      if(trashHeight>=trashLimit){ endGame(); }
    }
    spawnWaste();
  }

  drawBin();
  requestAnimationFrame(loop);
}

spawnWaste();
loop();
</script>
</body>
</html>
